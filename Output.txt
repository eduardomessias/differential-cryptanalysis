Differential Cryptanalysis on FEAL-4 using chosen-plaintext attack
By Eduardo Messias

------------------------------------
Meet-in-the-middle attack:
Round 4:
Generating plain/ciphertext pairs for differential 0x8080000080800000...
[0] P0-C0: 0xf65c0c553993fc6d-0xe35eaec4c90e7d68, P1-C1: 0x76dc0c55b913fc6d-0x830e3cc811c60cf3
[1] P0-C0: 0x2f80d6beee941e30-0x9b1d6626adb509fc, P1-C1: 0xaf00d6be6e141e30-0x321ffdc2ec3ff298
[2] P0-C0: 0xd311a0165060026f-0x862382eb894d5c81, P1-C1: 0x5391a016d0e0026f-0xda6d6803ac8b96e9
[3] P0-C0: 0x8258aeb8ea8143e5-0xe7aa38ee52b4c6d5, P1-C1: 0x2d8aeb86a0143e5-0x3a9bd9a1e3fa321
[4] P0-C0: 0x64cd89ef8d552d76-0x5bc34a32a0529f03, P1-C1: 0xe44d89ef0dd52d76-0xa602ce22851b3b93
[5] P0-C0: 0x451c8e0967443c7-0x75a60e264125c2e2, P1-C1: 0x84d1c8e016f443c7-0xa2a39fe64ed833a3
[6] P0-C0: 0xf137081a2482aec6-0xc2543be011b79a7a, P1-C1: 0x71b7081aa402aec6-0x9697ca6b910d4760
[7] P0-C0: 0xb14075125ceba79c-0xa8b6329594fd3cfd, P1-C1: 0x31c07512dc6ba79c-0xc208ff7666dbd19d
[8] P0-C0: 0x8167967fa409b0e7-0xdb2ea2be5cec3411, P1-C1: 0x1e7967f2489b0e7-0x16c28963e269eb9
[9] P0-C0: 0x6d3d929ecf17404e-0xab160b1fdb5d8558, P1-C1: 0xedbd929e4f97404e-0x1214923bfae73cfc
[10] P0-C0: 0x32b41f7842bdb50d-0x3d27d0eac77606d1, P1-C1: 0xb2341f78c23db50d-0x57723ed7d4ab0b53
[11] P0-C0: 0xce302d3ef8f232fe-0xeeac0f202ee945c1, P1-C1: 0x4eb02d3e787232fe-0x93af88cdfb62a2ac
Recovering last round subkey using output differential 0x02000000...
Found subkey: 0x6e141e30
Recovering subkey took 121 seconds.
Round 3:
Generating plain/ciphertext pairs for differential 0x0000000080800000...
[0] P0-C0: 0xc655be4569cb8caf-0x2c76455c60ff397, P1-C1: 0xc655be45e94b8caf-0x2cea71ba34616820
[1] P0-C0: 0xa9fbc24de8cff818-0x1f4ef7f6620711c8, P1-C1: 0xa9fbc24d684ff818-0x714c4481e9041cb7
[2] P0-C0: 0x5f6a029ca6f9dcdd-0x929b78f04fa339aa, P1-C1: 0x5f6a029c2679dcdd-0x2f86bb07d0fe7959
[3] P0-C0: 0x66441718f813d4bc-0x8f69728d6d0f90b7, P1-C1: 0x664417187893d4bc-0x3479364d72dc5343
[4] P0-C0: 0x1014c4b4737fcd22-0xa64e47b7e014bba6, P1-C1: 0x1014c4b4f3ffcd22-0xdb41d6c61311b660
[5] P0-C0: 0x7d1ebecfc752814d-0x7850cd54a4ee74d3, P1-C1: 0x7d1ebecf47d2814d-0x28b1f081d14ed77e
[6] P0-C0: 0xe38ebc2e2f1dacc-0x519bd3e3e5ca6a28, P1-C1: 0xe38ebc26271dacc-0x6d4213314512278e
[7] P0-C0: 0x142b74aa1d87da80-0xeda1013f94b9eecf, P1-C1: 0x142b74aa9d07da80-0x5592cd2e91cba4d6
[8] P0-C0: 0x32f087526730dceb-0x29c9c05b075c7e28, P1-C1: 0x32f08752e7b0dceb-0xc0172c4c1400eade
[9] P0-C0: 0x49a04fffd503a90a-0xa6ce14bbffa1c2f, P1-C1: 0x49a04fff5583a90a-0xcb0ca9e4b6d80beb
[10] P0-C0: 0x529b7bfc85e8b8df-0x1636b5adf1c48a9, P1-C1: 0x529b7bfc0568b8df-0xd242dcf7bbb867a8
[11] P0-C0: 0x93157dfb8d9ba329-0xd8ea1c1b086ed52d, P1-C1: 0x93157dfb0d1ba329-0x9b52fda7d1e8d82d
Recovering last round subkey using output differential 0x02000000...
Found subkey: 0x2d80563e
Recovering subkey took 49 seconds.
Round 2:
Generating plain/ciphertext pairs for differential 0x0000000002000000...
[0] P0-C0: 0xdd35a9a31a38c7f9-0x37805ee161bdb8f0, P1-C1: 0xdd35a9a31838c7f9-0x270e54b92f169618
[1] P0-C0: 0x7c2c1ad52af0e552-0x13d5295745b6b812, P1-C1: 0x7c2c1ad528f0e552-0xc71eab7b398b8ed
[2] P0-C0: 0xe1161119881141b2-0x5056ddff88437500, P1-C1: 0xe11611198a1141b2-0x946a64342f170936
[3] P0-C0: 0x44f6bf7d3e478aa3-0xfecabd1befbe60a1, P1-C1: 0x44f6bf7d3c478aa3-0x66a0a4730cb90bb
[4] P0-C0: 0x83c9864b01f34d8d-0x829e44cb1230f775, P1-C1: 0x83c9864b03f34d8d-0xd19a642eaf75943c
[5] P0-C0: 0x92b384cd82e0f87e-0x7db84c9c1cdfa2b2, P1-C1: 0x92b384cd80e0f87e-0x7f84c047047fc767
[6] P0-C0: 0x208050f8d4af584-0xd0f13ca24349707e, P1-C1: 0x208050f8f4af584-0xc8c9a5df8123bb2b
[7] P0-C0: 0xa7e844242ab3851d-0x1e416e91940ef74f, P1-C1: 0xa7e8442428b3851d-0xdfc8169bcef94876
[8] P0-C0: 0xedc744ec4d1669f4-0x8429f6f7c6eaeed, P1-C1: 0xedc744ec4f1669f4-0xb678a45a8731bdd
[9] P0-C0: 0x5fc178074f4640d7-0x2d25edc53ff04c48, P1-C1: 0x5fc178074d4640d7-0x7b614e67102a66d4
[10] P0-C0: 0x8920d757828ace16-0x3e446cd53a604fe3, P1-C1: 0x8920d757808ace16-0x288e5cd487bd71f9
[11] P0-C0: 0x96d4c0d158ba1a9d-0xc5db102f82204f99, P1-C1: 0x96d4c0d15aba1a9d-0xa4ec261a0cdd4e03
Recovering last round subkey using output differential 0x02000000...
Found subkey: 0x39937cef
Recovering subkey took 63 seconds.
Round 1:
found key K0: 0x74dc0c57
found key K4: 0xd111a014
found key K5: 0x5060026f
Total time: 373 seconds.
Testing...
Generating plain/ciphertext pairs for differential 0x123fec3c243ba9b2...
[0] P0-C0: 0x6ee618b5568c95fa-0x7309aa8bd007c6e5, P1-C1: 0x7cd9f48972b73c48-0x7ec07f42e350fcf6
[1] P0-C0: 0xda501c1e7e59ea05-0x46418d9910465348, P1-C1: 0xc86ff0225a6243b7-0xf0e5ce5fc146e0a9
[2] P0-C0: 0x6643bcc0a7bfeb67-0x67397af9fa525ab9, P1-C1: 0x747c50fc838442d5-0xfa6dec2758badfd8
[3] P0-C0: 0x6631e69fa642dddb-0xa67d21bbb5b7f369, P1-C1: 0x740e0aa382797469-0xdd7c482bf289589e
[4] P0-C0: 0x6633859715aede1f-0x416b8ab4a8c97f63, P1-C1: 0x740c69ab319577ad-0xdcf5d7d9abfcfb0b
[5] P0-C0: 0x28cd34bc2e6edcef-0x5be35bddca0d847f, P1-C1: 0x3af2d8800a55755d-0x2e658c53036b660b
[6] P0-C0: 0x2655c79827701ce5-0xf217a55268439fd5, P1-C1: 0x346a2ba4034bb557-0x1ff8b900599d2137
[7] P0-C0: 0x4abd6040fc84b9a3-0xf5c6660601f10ef5, P1-C1: 0x58828c7cd8bf1011-0x8c6fe994bf56e902
[8] P0-C0: 0x78f553104f9d5346-0xeac9ddf985694af2, P1-C1: 0x6acabf2c6ba6faf4-0xd31fe7cfc44e463c
[9] P0-C0: 0x6f2ecdf63d4bd571-0xcea5a41e5e8b465a, P1-C1: 0x7d1121ca19707cc3-0xd4c3dbe93f8d4021
[10] P0-C0: 0x8ab6e50ac0d8f0e8-0x6632e04c5063eba, P1-C1: 0x98890936e4e3595a-0xe8f6bf59988a09ae
[11] P0-C0: 0xcbaa671acec331dd-0x3336762d677d5b28, P1-C1: 0xd9958b26eaf8986f-0x13aabb85d3abc418
Test passed. Each ciphertext generated using the keys obtained in the method are matching.
Finished successfully.
